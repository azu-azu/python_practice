12:20

## ✅ 使い勝手

* **小規模データ（数百件以下）** → Merge Sort（安定＆速い）
* **大規模データ（数千〜数万件）** → Quick Sort（不安定でも速い）
* **安定性が必要＆メモリ制限ある** → **安定インプレース版Quick Sort** or **シェルソート**
* **Bubble Sort**はほぼ練習用オンリー（数百件でも体感遅い）

---

## 🧠 なぜBubble Sortは現実向きじゃない？

* 計算量 O(n²) で、10000件なら約1億回比較
* VBAの単純ループだと体感で**数十秒〜数分**かかる
* メモリはほぼ使わんけど、**時間がボトルネック**になる

---

## 💡 VBAでの現実的な代案

### 1. **Quick Sort**（不安定）

* メモリ消費少ない（インプレース）
* 実装もそこまで複雑じゃない
* 同値順序を保持したいなら、キーに**元の行番号を副キーとして追加**

### 2. **シェルソート（Shell Sort）**

* メモリ使用少なめ
* BubbleやInsertionよりだいぶ速い
* 安定じゃないけど、ある程度大きなデータでも現実的に動く

### 3. **2段階ソート**

* まず副キー（順序保持用）でソート
* 次にメインキーでQuick Sort
* 順序保持が必要な場面でも**見かけ上安定**になる

---

## 📦 ふじこおすすめ運用表

| 件数        | 安定性要否 | 推奨アルゴリズム                 |
| --------- | ----- | ------------------------ |
| 〜500件     | 必要    | Merge Sort               |
| 〜500件     | 不要    | Quick Sort               |
| 500〜5000件 | 必要    | 安定化Quick Sort（副キー）       |
| 500〜5000件 | 不要    | Quick Sort               |
| 5000件〜    | 必要    | 外部ソート or DBでORDER BY     |
| 5000件〜    | 不要    | Shell Sort or Quick Sort |

---
